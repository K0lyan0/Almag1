# Almag1
Переборка аппарата Алмаг1
Описание проблемы: не подается питание на катушки. Все четыре катушки нормально прозваниваются. Есть подозрение на пробитые диоды и мосфеты перед катушками.

## 1) Информация по прибору:
### а) Взято с сайта https://cxem.net/medic/medic39.php

В сети легко находится схема старой версии Алмаг-01, где применены счётчики и дешифраторы серии 561 (есть в приложении к тексту). Принесённый же аппарат был собран уже на PIC-контроллере 12F509, поэтому во время первого ремонта пришлось срисовывать принципиальную схему с печатной платы (рис.3).
Элементы FU2, VR1, C2, FU1, Tv1, R2 и R8 можно отнести к цепи питания 220 В – это и защита аппарата от возможного перенапряжения в сети и защита сети от возникающей в аппарате импульсной помехи.

Диод VD2 пропускает только положительные полуволны сетевого напряжения, а после него нет накопительного конденсатора и это говорит о том, что вся силовая часть (транзисторы VT1…VT4 и их нагрузка в виде катушек-индукторов) работает только во время появления этих полуволн.

Их наличие также контролируется PIC-контроллером по цепи R1, R3, R7, VD5, C5 и R6. Питание микросхемы обеспечивается элементами C1, VD3, VD4, C3, R4, VD6, C4, VD11 и C6.

Отрицательные полуволны, проходя через диод VD1 и ограничиваясь стабилитроном VD12 на уровне 3 В, вызывают свечение зелёного светодиода HL1 «СЕТЬ».
Жёлтый светодиод HL2 (индикатор режима «РАБОТА») загорается при запуске программы PIC-контроллера. Во время работы программы на выводах 3, 5, 6 и 7 микросхемы появляется «бегущий» импульс, который управляет транзисторами VT1-VT8. Питание силовых транзисторов VT1-VT4, как было сказано выше, происходит при положительных высоковольтных импульсах, а VT5-VT8 питаются постоянным напряжением +12 В (VD4, C3).

Сами катушки-индукторы состоят из последовательно включенной многовитковой катушки и резистора сопротивлением 2,2 Ом (видно на рис.2). Параллельно резистору стоит светодиод зелёного цвета свечения, который светится во время появления напряжения на катушке.

В инструкции к аппарату Алмаг-01 указано, что импульс, протекающий в катушке-индукторе имеет длительность 1,5-2,5 мс и следует с частотой 6,25 Гц (инструкция в приложении к тексту).

![image](https://user-images.githubusercontent.com/110164325/187070988-c9a79a22-a25c-4e47-9b47-38c744168fc9.png)

Список деталей к схеме

| №  |            Обозначение          |                       Тип                     |        Номинал       |      Количество     |      Примечание     |
|----|:-------------------------------:|:---------------------------------------------:|:--------------------:|:-------------------:|:-------------------:|
| 1  |     DD1                         |     МК PIC 8-бит                              |     PIC12F509        |     1               |                     |
| 2  |     VT1...VT4                   |     MOSFET-транзистор                         |     STP5NK50Z        |     4               |                     |
| 3  |     VT5...VT8                   |     Биполярный транзистор                     |     BC847B           |     4               |                     |
| 4  |     VD1, VD3, VD11              |     Выпрямительный диод                       |     BAS16            |     3               |                     |
| 5  |     VD2, VD5, VD7...VD10        |     Выпрямительный диод                       |     S1M              |     6               |                     |
| 6  |     VD4                         |     Стабилитрон                               |     BZX84-C12        |     1               |                     |
| 7  |     VD6                         |     Стабилитрон                               |     BZX84-C5V6       |     1               |                     |
| 8  |     VD12                        |     Стабилитрон                               |     BZX84-C3V0       |     1               |                     |
| 9  |     HL1                         |     Светодиод                                 |     L-513GD          |     1               |                     |
| 10 |     HL2                         |     Светодиод                                 |     L-513YD          |     1               |                     |
| 11 |     R1                          |     Резистор                                  |     1 кОм            |     1               |     0,5...1 Вт      |
| 12 |     R2, R8                      |     Резистор                                  |     150 кОм          |     2               |     smd 0805        |
| 13 |     R3, R7                      |     Резистор                                  |     510 кОм          |     2               |     smd 0805        |
| 14 |     R4                          |     Резистор                                  |     1 кОм            |     1               |     smd 0805        |
| 15 |     R5                          |     Резистор                                  |     510 Ом           |     1               |     smd 0805        |
| 16 |     R6                          |     Резистор                                  |     30 кОм           |     1               |     smd 0805        |
| 17 |     R9, R11, R13, R15           |     Резистор                                  |     13 кОм           |     4               |     smd 0805        |
| 18 |     R10, R12, R14, R16...R20    |     Резистор                                  |     22 кОм           |     8               |     smd 0805        |
| 19 |     VR1                         |     Варистор                                  |     10 кОм           |     1               |                     |
| 20 |     C1                          |     Конденсатор                               |     330 нФ. 400 В    |     1               |                     |
| 21 |     C2                          |     Конденсатор                               |     100 нФ. 400 В    |     1               |                     |
| 22 |     C5                          |     Конденсатор                               |     1 нФ             |     1               |     smd 0805        |
| 23 |     C6                          |     Конденсатор                               |     50 нФ            |     1               |     smd 0805        |
| 24 |     C3                          |     Электролитический конденсатор             |     470 мкФ. 16 В    |     1               |                     |
| 25 |     C4                          |     Электролитический конденсатор             |     47 мкФ. 16 В     |     1               |                     |
| 26 |     Tv1                         |     Фильтр сетевой                            |     PLA10            |     1               |                     |
| 27 |     FU1                         |     Предохранитель плавкий                    |     RV25F            |     1               |                     |
| 28 |     FU2                         |     Предохранитель самовосстанавливающийся    |     2 А              |     1               |     MF-R            |

### разметку таблички делал в https://www.tablesgenerator.com/markdown_tables

### б) Взято с сайта http://www.medteh.info/forum/34-3229-1
![image](https://user-images.githubusercontent.com/110164325/187071424-b59b7e5d-6259-4a25-b699-bc3270f0b0d6.png)
![image](https://user-images.githubusercontent.com/110164325/187071431-d52ab218-3ebb-449d-9f69-f91798529708.png)
![image](https://user-images.githubusercontent.com/110164325/187071434-0634787e-b6f0-4ad1-aca2-12d8e8cadf59.png)
![image](https://user-images.githubusercontent.com/110164325/187071444-13e8e180-0a32-441a-b8a6-cb96491769d1.png)

## 2) Ход проверки деталей
а) проверка катушек на обрыв. Обрыв отсутствует.

б) проверка катушек на короткое замыкание. Отсуствует.

в) проверка управляющих Mosfet. Vt2 пробит. Сопротивление между затвором и истоком/стоком 25кОм. Выпаял и отключил катушку. Эффекта не дало.

г) в плане неработающих катушек - они работают, но несколько секунд. А потом гаснут. Думал, что микроконтроллер. Оказалось, что полумертвый предохранитель rv25f. Сопротивление без нагрузки 300+ Ом. Хотя в норме должно 2-10 оМ. Далее при подаче питания сопротивление уходит в несколько мегаОм. Превышения по току не увидел.

д) конденсаторы и варистор целые.
## 3) Поиск аналогов с деталей
а) В плане замены STP5NK50Z >>>Irf840

